
SELECT SUM(COUNT) FROM 

((select count (distinct C.COMPANY_PK) AS COUNT 

from  "BRONZE_CE"."CE_PROD_01_DBO"."EXP" E 
JOIN "BRONZE_CE"."CE_PROD_01_DBO"."EMP" P ON P.EMP_PK = E.EXP_EMPFK
JOIN "BRONZE_CE"."CE_PROD_01_DBO"."COMPANY" C ON C.COMPANY_PK = P.EMP_COMPANYFK

where E._FIVETRAN_DELETED= FALSE AND P._FIVETRAN_DELETED=FALSE AND C._FIVETRAN_DELETED=FALSE
AND E.EXP_PCARDFK IS NOT NULL)

UNION ALL 


(select count (distinct C.COMPANY_PK) AS COUNT

from  "BRONZE_CE"."CE_PROD_02_DBO"."EXP" E 
JOIN "BRONZE_CE"."CE_PROD_02_DBO"."EMP" P ON P.EMP_PK = E.EXP_EMPFK
JOIN "BRONZE_CE"."CE_PROD_02_DBO"."COMPANY" C ON C.COMPANY_PK = P.EMP_COMPANYFK

where E._FIVETRAN_DELETED= FALSE AND P._FIVETRAN_DELETED=FALSE AND C._FIVETRAN_DELETED=FALSE
AND E.EXP_PCARDFK IS NOT NULL
)

UNION ALL

(select count (distinct C.COMPANY_PK) AS COUNT

from  "BRONZE_CE"."CE_PROD_03_DBO"."EXP" E 
JOIN "BRONZE_CE"."CE_PROD_03_DBO"."EMP" P ON P.EMP_PK = E.EXP_EMPFK
JOIN "BRONZE_CE"."CE_PROD_03_DBO"."COMPANY" C ON C.COMPANY_PK = P.EMP_COMPANYFK

where E._FIVETRAN_DELETED= FALSE AND P._FIVETRAN_DELETED=FALSE AND C._FIVETRAN_DELETED=FALSE
AND E.EXP_PCARDFK IS NOT NULL
)
 

UNION ALL

(select count (distinct C.COMPANY_PK) AS COUNT 

from  "BRONZE_CE"."CE_PROD_04_DBO"."EXP" E 
JOIN "BRONZE_CE"."CE_PROD_04_DBO"."EMP" P ON P.EMP_PK = E.EXP_EMPFK
JOIN "BRONZE_CE"."CE_PROD_04_DBO"."COMPANY" C ON C.COMPANY_PK = P.EMP_COMPANYFK

where E._FIVETRAN_DELETED= FALSE AND P._FIVETRAN_DELETED=FALSE AND C._FIVETRAN_DELETED=FALSE
AND E.EXP_PCARDFK IS NOT NULL
)
)
