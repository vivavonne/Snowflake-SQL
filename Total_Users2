//Total Users
select SUM (*) AS TOTAL_USERS FROM 

((SELECT count(distinct(c.customerid))  
   from "BRONZE_CR"."CR_C1_PROD_CHROME_EXPENSE"."TBL_CUSTOMER" C 
JOIN "BRONZE_CR"."CR_C1_PROD_CHROME_EXPENSE"."TBL_EXPENSETRANSACTION" T ON T.CUSTOMERID = C. CUSTOMERID
JOIN "BRONZE_CR"."CR_C1_PROD_CHROME_EXPENSE"."TBL_FEED" F ON F.FEEDID = T.FEEDID
JOIN "BRONZE_CR"."CR_C1_PROD_CHROME_EXPENSE"."TBL_FEEDTYPE" FT ON FT.FEEDTYPEID = F.FEEDTYPEID
 
where 
 C._FIVETRAN_DELETED = FALSE  AND T._FIVETRAN_DELETED = FALSE AND F._FIVETRAN_DELETED = FALSE AND FT. _FIVETRAN_DELETED = FALSE
and ft.feedtypeid NOT in (1,2,5,6)
 )
 
UNION ALL 
(SELECT count(distinct(c.customerid))  
    from "BRONZE_CR"."CR_C1_PROD_CHROME_EXPENSE"."TBL_CUSTOMER" C 
JOIN "BRONZE_CR"."CR_C1_PROD_CHROME_EXPENSE"."TBL_EXPENSETRANSACTION" T ON T.CUSTOMERID = C. CUSTOMERID
JOIN "BRONZE_CR"."CR_C2_PROD_CHROME_EXPENSE"."TBL_FEED" F ON F.FEEDID = T.FEEDID
JOIN "BRONZE_CR"."CR_C2_PROD_CHROME_EXPENSE"."TBL_FEEDTYPE" FT ON FT.FEEDTYPEID = F.FEEDTYPEID
 
where 
C._FIVETRAN_DELETED = FALSE  AND T._FIVETRAN_DELETED = FALSE AND F._FIVETRAN_DELETED = FALSE AND FT. _FIVETRAN_DELETED = FALSE
and ft.feedtypeid NOT in (1,2,5,6)
 )
 

 
UNION ALL
 
(SELECT count(distinct(c.customerid))  
   from "BRONZE_CR"."CR_C1_PROD_CHROME_EXPENSE"."TBL_CUSTOMER" C 
JOIN "BRONZE_CR"."CR_C1_PROD_CHROME_EXPENSE"."TBL_EXPENSETRANSACTION" T ON T.CUSTOMERID = C. CUSTOMERID
JOIN "BRONZE_CR"."CR_C7_PROD_CHROME_EXPENSE"."TBL_FEED" F ON F.FEEDID = T.FEEDID
JOIN "BRONZE_CR"."CR_C7_PROD_CHROME_EXPENSE"."TBL_FEEDTYPE" FT ON FT.FEEDTYPEID = F.FEEDTYPEID
 
where 
C._FIVETRAN_DELETED = FALSE  AND T._FIVETRAN_DELETED = FALSE AND F._FIVETRAN_DELETED = FALSE AND FT. _FIVETRAN_DELETED = FALSE
 and ft.feedtypeid NOT in (1,2,5,6)
 ))
